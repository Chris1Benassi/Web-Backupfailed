---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';

const posts = await getCollection('posts');
---

<Layout title="Blog">
    <section class="max-w-6xl mx-auto px-6 py-12">
        <h1 class="text-4xl font-bold mb-8">Blog</h1>
        <input type="text" placeholder="Search articles..." class="w-full p-2 border border-gray-300 rounded mb-6" oninput="filterPosts(event)" />
        <ul id="post-list" class="grid gap-6">
            {
                posts.map((post) => (
                    <li data-tags={post.data.tags.join(' ')}>
                        <a href={`/blog/${post.slug}`} class="block p-4 border border-gray-300 rounded hover:bg-gray-100">
                            <h2 class="text-2xl font-bold">{post.data.title}</h2>
                            <p class="text-gray-500">{post.data.date}</p>
                            <p class="text-sm text-gray-700">{post.data.tags.join(', ')}</p>
                        </a>
                    </li>
                ))
            }
        </ul>
    </section>
</Layout>

<script>
    function filterPosts(event) {
        const query = event.target.value.toLowerCase();
        document.querySelectorAll('#post-list li').forEach((li) => {
            const matches = li.textContent.toLowerCase().includes(query);
            (li as HTMLElement).style.display = matches ? '' : 'none';
        });
    }
</script>
